#!/bin/bash
# Start Gradio Demo with timestamp logging

cd /srv/dots.ocr/dots.ocr-ultimate

source venv/bin/activate

export PYTHONPATH=/srv/dots.ocr/dots.ocr-ultimate:$PYTHONPATH

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ Ð»Ð¾Ð³Ð¾Ð² ÐµÑÐ»Ð¸ ÐµÑ‘ Ð½ÐµÑ‚
mkdir -p logs

# Timestamp Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ
log_with_timestamp() {
    while IFS= read -r line; do
        echo "[$(date '+%Y-%m-%d %H:%M:%S')] $line"
    done
}

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "ðŸš€ Starting dots.ocr Gradio Demo at $(date '+%Y-%m-%d %H:%M:%S')"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ñ‡ÐµÑ€ÐµÐ· timestamp
python -u demo/demo_simple.py 7860 2>&1 | log_with_timestamp | tee logs/demo_$(date '+%Y%m%d_%H%M%S').log

